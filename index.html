<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>W2H Tool v1.8 â€“ Live Place ID Fetch (via Proxy, ohne Token)</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #d6f3ee;
      padding: 20px;
    }
    input, button, textarea {
      width: 100%; padding: 10px; margin-top: 8px;
      font-family: monospace;
    }
    textarea { height: 200px; }
    .ok { color: green; }
    .error { color: red; }
  </style>
</head>
<body>

<h2>ğŸŒ W2H Tool v1.8 â€“ Live Place ID Fetch (via Proxy, ohne Token)</h2>

<label>ğŸ”¤ Eingabe (z.â€¯B. Plus Code oder Ortsname):</label>
<input id="inputText" placeholder="z.â€¯B. 9C3W+X7 Wien oder Hotel Lipa Piran" />

<label>ğŸ“¦ GitHub Repo (z.â€¯B. Sailbuddy/w2h-places-import):</label>
<input id="repo" value="Sailbuddy/w2h-places-import" />

<button onclick="los()">â¡ï¸ Place ID abrufen & speichern</button>

<h3>ğŸ“„ Log</h3>
<textarea id="log" readonly></textarea>

<script>
  async function los() {
    const input = document.getElementById("inputText").value.trim();
    const repo = document.getElementById("repo").value.trim();
    const log = document.getElementById("log");

    if (!input || !repo) {
      log.value += "âš ï¸ Bitte Eingabe und Repo prÃ¼fen\n";
      return;
    }

    log.value += `ğŸ” Suche Ort: ${input}\n`;

    try {
      const url = `https://w2h-proxy.netlify.app/.netlify/functions/places?input=${encodeURIComponent(input)}&repo=${encodeURIComponent(repo)}`;
      const response = await fetch(url);
      const result = await response.json();

      if (result.error) {
        log.value += `âŒ Fehler: ${result.error}\n`;
        return;
      }

      log.value += `âœ… Gefunden: ${input} â†’ ${result.place_id}\n`;

      result.results.forEach(entry => {
        if (entry.ok) {
          log.value += `âœ… Hochgeladen nach ${entry.path}\n`;
        } else {
          log.value += `âŒ Fehler bei ${entry.path}: Status ${entry.status}\n`;
        }
      });

    } catch (err) {
      log.value += `ğŸ”¥ Fehler bei der Abfrage:\n${err}\n`;
    }
  }
</script>

</body>
</html>
